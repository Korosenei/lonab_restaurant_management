{% extends 'dashboards/base_dashboard.html' %}
{% load static %}

{% block title %}Restaurants{% endblock %}
{% block dashboard_css %}<link rel="stylesheet" href="{% static 'css/components.css' %}">{% endblock %}

{% block sidebar_menu %}{% include 'dashboards/sidebars/client_sidebar.html' %}{% endblock %}

{% block page_content %}
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;">
    <div>
        <h1 style="font-size:20px;font-weight:700;margin:0;color:var(--text-primary);">
            <i class="fas fa-utensils" style="color:var(--primary-green);margin-right:8px;"></i>Restaurants disponibles
        </h1>
        <p style="color:var(--text-muted);font-size:12px;margin:3px 0 0;">
            {{ aujourd_hui|date:"l d F Y" }}
            {% if agence %} · <strong>{{ agence.nom }}</strong>{% endif %}
        </p>
    </div>
    <a href="{% url 'restaurants:client_menus' %}" class="btn btn-primary" style="font-size:13px;padding:8px 14px;">
        <i class="fas fa-book-open"></i> Menus du jour
    </a>
</div>

{% if restaurants_programmes %}
<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px;">
    {% for restaurant in restaurants_programmes %}
    <div class="card" style="overflow:hidden;transition:.2s;" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 16px rgba(0,0,0,.1)'" onmouseout="this.style.transform='';this.style.boxShadow=''">
        <!-- Logo / visuel -->
        <div style="height:100px;background:linear-gradient(135deg,#1a5c2e,#28a745);display:flex;align-items:center;justify-content:center;position:relative;">
            {% if restaurant.logo %}
            <img src="{{ restaurant.logo.url }}" alt="{{ restaurant.nom }}" style="width:100%;height:100%;object-fit:cover;">
            {% else %}
            <i class="fas fa-utensils" style="font-size:36px;color:rgba(255,255,255,.5);"></i>
            {% endif %}
            <span class="badge badge-success" style="position:absolute;top:10px;right:10px;font-size:10px;">Programmé</span>
        </div>
        <div style="padding:14px;">
            <h3 style="font-size:14px;font-weight:700;margin:0 0 4px;color:var(--text-primary);">{{ restaurant.nom }}</h3>
            <div style="font-size:12px;color:var(--text-muted);margin-bottom:10px;line-height:1.6;">
                {% if restaurant.adresse %}<div><i class="fas fa-map-marker-alt" style="width:14px;color:var(--primary-green);"></i> {{ restaurant.adresse }}</div>{% endif %}
                {% if restaurant.ville %}<div><i class="fas fa-city" style="width:14px;color:var(--primary-green);"></i> {{ restaurant.ville }}</div>{% endif %}
                {% if restaurant.telephone %}<div><i class="fas fa-phone" style="width:14px;color:var(--primary-green);"></i> {{ restaurant.telephone }}</div>{% endif %}
            </div>
            <a href="{% url 'restaurants:client_menus' %}?restaurant={{ restaurant.id }}" class="btn btn-outline" style="width:100%;font-size:12px;text-align:center;">
                <i class="fas fa-book-open"></i> Voir les plats du jour
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div style="background:white;border-radius:12px;padding:48px;text-align:center;box-shadow:0 1px 6px rgba(0,0,0,.07);">
    {% if not agence %}
    <i class="fas fa-building" style="font-size:40px;color:#adb5bd;display:block;margin-bottom:14px;"></i>
    <h2 style="font-size:16px;font-weight:700;margin:0 0 8px;">Aucune agence assignée</h2>
    <p style="color:var(--text-muted);font-size:13px;margin:0;">Votre compte n'est pas encore rattaché à une agence. Contactez votre administrateur.</p>
    {% else %}
    <i class="fas fa-calendar-times" style="font-size:40px;color:#adb5bd;display:block;margin-bottom:14px;"></i>
    <h2 style="font-size:16px;font-weight:700;margin:0 0 8px;">Aucun restaurant programmé</h2>
    <p style="color:var(--text-muted);font-size:13px;margin:0;">Aucun restaurant n'est actuellement programmé pour votre agence <strong>{{ agence.nom }}</strong>.</p>
    {% endif %}
</div>
{% endif %}
{% endblock %}

{% block dashboard_js %}<script src="{% static 'js/components.js' %}"></script>{% endblock %}